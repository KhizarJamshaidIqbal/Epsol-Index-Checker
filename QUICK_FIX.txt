╔══════════════════════════════════════════════════════════════════════════════╗
║                  🔥 FIX 500 ERROR IN 5 MINUTES 🔥                            ║
╚══════════════════════════════════════════════════════════════════════════════╝

PROBLEM: Email authentication fails with 500 error on Vercel
CAUSE: Environment variables NOT configured on Vercel
FIX: Add variables to Vercel dashboard (5 minutes)

═══════════════════════════════════════════════════════════════════════════════

STEP 1: Go to Vercel
→ https://vercel.com/dashboard
→ Click: epsol-index-checker
→ Click: Settings
→ Click: Environment Variables

═══════════════════════════════════════════════════════════════════════════════

STEP 2: Add These 8 Variables

For EACH variable below, click "Add New" and copy the values exactly:

┌─────────────────────────────────────────────────────────────────────────────┐
│ 1. EMAIL_SERVER_HOST                                                        │
│    Value: epsoldev.com                                                      │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 2. EMAIL_SERVER_PORT                                                        │
│    Value: 465                                                               │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 3. EMAIL_SERVER_USER                                                        │
│    Value: epsolindexchecker@epsoldev.com                                    │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 4. EMAIL_SERVER_PASSWORD                                                    │
│    Value: JinnahEnt786                                                      │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 5. EMAIL_FROM                                                               │
│    Value: epsolindexchecker@epsoldev.com                                    │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 6. NEXTAUTH_URL                                                             │
│    Value: https://epsol-index-checker.vercel.app                            │
│    Environments: ☑ Production ONLY                                          │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 7. NEXTAUTH_SECRET                                                          │
│    First, run this in PowerShell to generate a secret:                     │
│                                                                             │
│    $random = New-Object byte[] 32                                           │
│    [System.Security.Cryptography.RNGCryptoServiceProvider]::Create().\     │
│       GetBytes($random)                                                     │
│    [Convert]::ToBase64String($random)                                       │
│                                                                             │
│    Copy the output and use it as the value                                  │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│ 8. DATABASE_URL                                                             │
│    Value: postgresql://epsol_user:epsol_password%40786@69.57.161.70:5432/\ │
│           epsol_indexing                                                    │
│    Environments: ☑ Production ☑ Preview ☑ Development                      │
└─────────────────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════════════════

STEP 3: REDEPLOY (CRITICAL!)

After adding ALL variables:

→ Click: Deployments tab
→ Click: Latest deployment (top one)
→ Click: "..." menu
→ Click: "Redeploy"
→ Wait 2-3 minutes

═══════════════════════════════════════════════════════════════════════════════

STEP 4: VERIFY

Open in browser:
https://epsol-index-checker.vercel.app/api/debug/env

Should show:
{
  "allEmailVarsSet": true
}

If false, go back and check which variables are missing!

═══════════════════════════════════════════════════════════════════════════════

STEP 5: TEST

→ Go to: https://epsol-index-checker.vercel.app/auth/signin
→ Enter email: khizarjamshaidiqbal@gmail.com
→ Click: "Sign in with Email"
→ ✅ No console errors
→ ✅ Check email inbox

═══════════════════════════════════════════════════════════════════════════════

CHECKLIST:

☐ Added all 8 environment variables
☐ Checked all 3 environments (Production, Preview, Development)
☐ Clicked "Save" for each variable
☐ Redeployed the application
☐ Waited for deployment to complete (green checkmark)
☐ Checked /api/debug/env shows allEmailVarsSet: true
☐ Tested sign-in - no errors
☐ Received email

═══════════════════════════════════════════════════════════════════════════════

IF STILL NOT WORKING:

1. Screenshot your Vercel Environment Variables page
2. Screenshot /api/debug/env output
3. Screenshot browser console
4. Check Vercel function logs for specific error

═══════════════════════════════════════════════════════════════════════════════

WHY THIS IS NEEDED:

Your local app works because it uses the .env file.
Vercel DOES NOT read .env files - you MUST add variables in the dashboard.

This is NOT a code problem - it's a configuration problem!

═══════════════════════════════════════════════════════════════════════════════
